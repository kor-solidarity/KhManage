<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Member">

	<resultMap type="Member" id="memberResultSet">
		<id property="memberNo" column="MEMBER_NO"/>
		<result property="memberId" column="MEMBER_ID"/>
		<result property="memberPwd" column="PASSWORD"/>
		<result property="memberName" column="MEMBER_NAME"/>
		<result property="phone" column="PHONE"/>
		<result property="email" column="EMAIL"/>
		<result property="memberType" column="MEMBER_TYPE"/>
		<result property="rankNo" column="RANK_NO"/>
		<result property="deptNo" column="DEFT_NO"/>
		<result property="enrollDate" column="ENROLL_DATE"/>
		<result property="status" column="STATUS"/>
	</resultMap>
	
	<select id="loginCheck" resultMap="memberResultSet" parameterType="Member">
		SELECT *
		FROM MEMBER
		WHERE MEMBER_ID = #{memberId}
		AND PASSWORD = #{memberPwd}
		AND STATUS = 'Y'
	</select>
	 
	<insert id="insertMember" parameterType="Member">
		INSERT INTO MEMBER
		<!-- VALUES (SEQ_MNO.NEXTVAL, #{memberId}, #{memberPwd}, #{memberName}, #{phone}, #{email}, #{memberType}, #{rankNo}, #{deptNo}, SYSDATE, SYSDATE, 'Y') -->
		VALUES ('M' || TO_CHAR(SEQ_MNO.NEXTVAL, 'FM000'), #{memberId}, #{memberPwd}, #{memberName}, #{phone}, #{email}, #{memberType}, #{rankNo}, #{deptNo}, SYSDATE, SYSDATE, 'Y')
	</insert>
	
	<select id="selectPwd" resultType="java.lang.String" parameterType="java.lang.String">
		SELECT PASSWORD
		FROM MEMBER
		WHERE MEMBER_ID = #{memberId}
		AND STATUS = 'Y'
	</select>
	
	<select id="selectLoginUser" resultMap="memberResultSet" parameterType="Member">
		SELECT *
		FROM MEMBER
		WHERE MEMBER_ID = #{memberId}
		AND STATUS = 'Y'
	</select>
	
	
	<!-- 아이디 중복확인 -->
	<select id="checkMemberId" resultType="_int">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE MEMBER_ID = #{memberId}
	</select>
	
	
	<!-- 회원정보 수정 페이지 -->
	<!-- <select id="selectMemberInfo" resultMap="memberResultSet">
		SELECT MEMBER_NAME, EMAIL, PHONE
		FROM MEMBER
		WHERE MEMBER_ID = #{memberId}
	</select> -->
	
	<!-- 회원정보 수정 : 비밀번호 수정 -->
	<update id="updatePassword" parameterType="Member">
		UPDATE MEMBER
		SET(PASSWORD, MODIFY_DATE) = (SELECT #{memberPwd}, SYSDATE
									  FROM MEMBER
									  WHERE MEMBER_ID = #{memberId})
		WHERE MEMBER_ID = #{memberId}
	</update>
	
	<update id="updateMemberInfo" parameterType="Member">
		UPDATE MEMBER
		SET(EMAIL, PHONE, MODIFY_DATE) = (SELECT #{email}, #{phone}, SYSDATE
										  FROM MEMBER
										  WHERE MEMBER_ID = #{memberId})
		WHERE MEMBER_ID = #{memberId}
	</update>
	
	

</mapper>










  